{
  "name" : "Supervisor VHSND Visit cancellation",
  "uuid" : "9539504c-979d-4201-80e5-a65a7e10a847",
  "formType" : "IndividualEncounterCancellation",
  "formElementGroups" : [ {
    "uuid" : "c0af005a-d066-45dc-bf29-0d1c9bc8ae53",
    "name" : "Cancel details",
    "displayOrder" : 1.0,
    "formElements" : [ ],
    "display" : "Cancel details",
    "timed" : false
  } ],
  "decisionRule" : "",
  "visitScheduleRule" : "//SAMPLE RULE EXAMPLE\n\"use strict\";\n({params, imports}) => {\n    const encounter = params.entity;\n    const scheduleBuilder = new imports.rulesConfig.VisitScheduleBuilder({\n        encounter\n    });\n    const moment = imports.moment;\n    const _ = imports.lodash;\n\n    const earliestDate = moment(encounter.earliestVisitDateTime).add(1, 'month').startOf('month');\n    const currentlyActive= !encounter.individual.voided;\n\n\n  let isAlreadyScheduled = _.some(encounter.individual.encounters, (enc) =>\n    enc.encounterType.name === 'Supervisor VHSND Visit' &&\n    enc.voided === false &&\n    moment(enc.earliestVisitDateTime).isSame(earliestDate, 'day')\n);\n\n\n    if(!isAlreadyScheduled && currentlyActive) {\n        scheduleBuilder.add({\n            name: 'Supervisor VHSND Visit',\n            encounterType: 'Supervisor VHSND Visit',\n            earliestDate: earliestDate.toDate(),\n            maxDate: earliestDate.endOf('month').toDate()\n        });\n    }\n\n    return scheduleBuilder.getAll();\n}",
  "validationRule" : "//SAMPLE RULE EXAMPLE\n'use strict';\n({params, imports}) => {\n  const encounter = params.entity;\n  const moment = imports.moment;\n  const validationResults = [];\n  //use imports.common.createValidationError('sample error') to create validation error and push it to validationResults\n  const isBeforeScheduleDate = moment(encounter.cancelDateTime)\n    .isBefore(moment(encounter.earliestVisitDateTime), 'day');\n\n  if (isBeforeScheduleDate) {\n    validationResults.push(\n      imports.common.createValidationError(\"Visit cannot be cancelled before the scheduled date\")\n    );\n  }\n  return validationResults;\n};",
  "checklistsRule" : "",
  "decisionConcepts" : [ ]
}