{
  "name" : "Claim Status Enrolment",
  "uuid" : "751bc765-86c8-49f6-86ec-fa1e8a8c86d7",
  "formType" : "ProgramEnrolment",
  "formElementGroups" : [ {
    "uuid" : "eaa2ea71-5013-4a9c-b5ce-5f4f5b88701f",
    "name" : "Application status",
    "displayOrder" : 1.0,
    "formElements" : [ {
      "name" : "Mark the current status of your application",
      "uuid" : "6025e9e6-5266-4194-91b8-7d1b1fef4579",
      "keyValues" : [ ],
      "concept" : {
        "name" : "Status",
        "uuid" : "f3ce6acf-60e2-4b93-8de0-40348e40db79",
        "dataType" : "Coded",
        "answers" : [ {
          "name" : "Active",
          "uuid" : "a291f5e8-9e80-4420-99de-67996e72dae3",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 0.0,
          "active" : true,
          "media" : [ ]
        }, {
          "name" : "Resolved",
          "uuid" : "65688e86-a632-4e70-9ef8-4f19b0fc3bee",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 1.0,
          "active" : true,
          "media" : [ ]
        }, {
          "name" : "Closed",
          "uuid" : "d56b69db-da83-4f60-9a3f-4cc159e5e191",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 2.0,
          "active" : true,
          "media" : [ ]
        } ],
        "active" : true,
        "media" : [ ]
      },
      "displayOrder" : 1.0,
      "type" : "SingleSelect",
      "mandatory" : true
    }, {
      "name" : "Date of closure",
      "uuid" : "de3df0be-a678-4e5e-9718-5b6334eb470d",
      "keyValues" : [ ],
      "concept" : {
        "name" : "Date of closure",
        "uuid" : "c2f6852a-8355-4c87-b7e5-22b75e9857f6",
        "dataType" : "Date",
        "answers" : [ ],
        "active" : true,
        "media" : [ ]
      },
      "displayOrder" : 2.0,
      "type" : "SingleSelect",
      "rule" : "'use strict';\n({params, imports}) => {\n  const programEnrolment = params.entity;\n  const moment = imports.moment;\n  const formElement = params.formElement;\n  const _ = imports.lodash;\n  let visibility = true;\n  let value = null;\n  let answersToSkip = [];\n  let validationErrors = [];\n  \n  const condition11 = new imports.rulesConfig.RuleCondition({programEnrolment, formElement}).when.valueInEnrolment(\"f3ce6acf-60e2-4b93-8de0-40348e40db79\").containsAnswerConceptName(\"d56b69db-da83-4f60-9a3f-4cc159e5e191\").matches();\n  \n  visibility = condition11 ;\n  \n  return new imports.rulesConfig.FormElementStatus(formElement.uuid, visibility, value, answersToSkip, validationErrors);\n};",
      "declarativeRule" : [ {
        "actions" : [ {
          "actionType" : "showFormElement"
        }, { } ],
        "conditions" : [ {
          "compoundRule" : {
            "rules" : [ {
              "lhs" : {
                "type" : "concept",
                "scope" : "enrolment",
                "conceptName" : "Status",
                "conceptUuid" : "f3ce6acf-60e2-4b93-8de0-40348e40db79",
                "conceptDataType" : "Coded"
              },
              "rhs" : {
                "type" : "answerConcept",
                "answerConceptNames" : [ "Closed" ],
                "answerConceptUuids" : [ "d56b69db-da83-4f60-9a3f-4cc159e5e191" ]
              },
              "operator" : "containsAnswerConceptName"
            } ]
          }
        } ]
      } ],
      "mandatory" : true
    }, {
      "name" : "Reason for closure",
      "uuid" : "c61ad1e8-5663-47af-a6c3-e6744a2f0377",
      "keyValues" : [ ],
      "concept" : {
        "name" : "Reason for closure",
        "uuid" : "d7eb6210-68e6-4b05-89de-ecc90da6c829",
        "dataType" : "Coded",
        "answers" : [ {
          "name" : "Client not contactable",
          "uuid" : "7a281f77-1cd1-4dfa-af06-ab638e79beef",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 1.0,
          "active" : true,
          "media" : [ ]
        }, {
          "name" : "Client does not want to proceed",
          "uuid" : "b691f1b9-dea1-4ae4-aabd-d49fde3041bf",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 0.0,
          "active" : true,
          "media" : [ ]
        }, {
          "name" : "Other reason for closure",
          "uuid" : "77cb1cae-2e41-4ad8-8baf-dac7b9fdebfc",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 2.0,
          "active" : true,
          "media" : [ ]
        } ],
        "active" : true,
        "media" : [ ]
      },
      "displayOrder" : 3.0,
      "type" : "SingleSelect",
      "rule" : "'use strict';\n({params, imports}) => {\n  const programEnrolment = params.entity;\n  const moment = imports.moment;\n  const formElement = params.formElement;\n  const _ = imports.lodash;\n  let visibility = true;\n  let value = null;\n  let answersToSkip = [];\n  let validationErrors = [];\n  \n  const condition11 = new imports.rulesConfig.RuleCondition({programEnrolment, formElement}).when.valueInEnrolment(\"f3ce6acf-60e2-4b93-8de0-40348e40db79\").containsAnswerConceptName(\"d56b69db-da83-4f60-9a3f-4cc159e5e191\").matches();\n  \n  visibility = condition11 ;\n  \n  return new imports.rulesConfig.FormElementStatus(formElement.uuid, visibility, value, answersToSkip, validationErrors);\n};",
      "declarativeRule" : [ {
        "actions" : [ {
          "actionType" : "showFormElement"
        }, { } ],
        "conditions" : [ {
          "compoundRule" : {
            "rules" : [ {
              "lhs" : {
                "type" : "concept",
                "scope" : "enrolment",
                "conceptName" : "Status",
                "conceptUuid" : "f3ce6acf-60e2-4b93-8de0-40348e40db79",
                "conceptDataType" : "Coded"
              },
              "rhs" : {
                "type" : "answerConcept",
                "answerConceptNames" : [ "Closed" ],
                "answerConceptUuids" : [ "d56b69db-da83-4f60-9a3f-4cc159e5e191" ]
              },
              "operator" : "containsAnswerConceptName"
            } ]
          }
        } ]
      } ],
      "mandatory" : true
    }, {
      "name" : "Other reason for closure, please specify",
      "uuid" : "94cf55e1-6e54-4a4a-baeb-645c01ab7970",
      "keyValues" : [ ],
      "concept" : {
        "name" : "Other reason for closure, please specify",
        "uuid" : "ffa956c5-a4cc-4c9b-a539-fd8193e29bac",
        "dataType" : "Text",
        "answers" : [ ],
        "active" : true,
        "media" : [ ]
      },
      "displayOrder" : 4.0,
      "type" : "SingleSelect",
      "rule" : "'use strict';\n({params, imports}) => {\n  const programEnrolment = params.entity;\n  const moment = imports.moment;\n  const formElement = params.formElement;\n  const _ = imports.lodash;\n  let visibility = true;\n  let value = null;\n  let answersToSkip = [];\n  let validationErrors = [];\n  \n  const condition11 = new imports.rulesConfig.RuleCondition({programEnrolment, formElement}).when.valueInEnrolment(\"d7eb6210-68e6-4b05-89de-ecc90da6c829\").containsAnswerConceptName(\"77cb1cae-2e41-4ad8-8baf-dac7b9fdebfc\").matches();\n  \n  visibility = condition11 ;\n  \n  return new imports.rulesConfig.FormElementStatus(formElement.uuid, visibility, value, answersToSkip, validationErrors);\n};",
      "declarativeRule" : [ {
        "actions" : [ {
          "actionType" : "showFormElement"
        }, { } ],
        "conditions" : [ {
          "compoundRule" : {
            "rules" : [ {
              "lhs" : {
                "type" : "concept",
                "scope" : "enrolment",
                "conceptName" : "Reason for closure",
                "conceptUuid" : "d7eb6210-68e6-4b05-89de-ecc90da6c829",
                "conceptDataType" : "Coded"
              },
              "rhs" : {
                "type" : "answerConcept",
                "answerConceptNames" : [ "Other reason for closure" ],
                "answerConceptUuids" : [ "77cb1cae-2e41-4ad8-8baf-dac7b9fdebfc" ]
              },
              "operator" : "containsAnswerConceptName"
            } ]
          }
        } ]
      } ],
      "mandatory" : true
    } ],
    "display" : "Application status",
    "timed" : false
  } ],
  "decisionRule" : "\"use strict\";\n({params, imports}) => {\n    const programEnrolment = params.entity;\n    const decisions = params.decisions;\n    const moment = imports.moment;\n    const enrolmentDecisions = [];\n    \n    const enrolmentDateForEditCase = programEnrolment.getObservationValue(\"3ecdf82a-adf3-4e29-aa3f-244db1109a2d\");\n    \n    if (!enrolmentDateForEditCase) {\n      let enrlDateTime = moment().format(\"YYYY-MM-DD HH:mm:ss\");\n      \n      if (enrlDateTime) {\n        enrolmentDecisions.push({ name: \"Enrolment DateTime\", value: enrlDateTime });\n      }\n      decisions.enrolmentDecisions.push(...enrolmentDecisions);\n    }\n    \n    return decisions;\n};",
  "visitScheduleRule" : "",
  "validationRule" : "'use strict';\n({params, imports}) => {\n  const programEnrolment = params.entity;\n  const moment = imports.moment;\n  const validationResults = [];\n  \n  const enrolmentDateForEditCase = programEnrolment.getObservationValue(\"3ecdf82a-adf3-4e29-aa3f-244db1109a2d\");\n  const enrolmentDate = programEnrolment.enrolmentDateTime;\n\n  if (!enrolmentDateForEditCase) {\n    if (enrolmentDate) {\n      const today = moment().startOf('day');\n      const enrlDate = moment(enrolmentDate).startOf('day');\n\n      if (!enrlDate.isSame(today, 'day')) {\n        validationResults.push(\n          imports.common.createValidationError(\"Enrolment Date should be today's date.\")\n        );\n      }\n    }\n  } else {\n    const enrlDateEdit = moment(enrolmentDate).startOf('day');\n    const enrlDateOriginal = moment(enrolmentDateForEditCase).startOf('day');\n\n    if (!enrlDateEdit.isSame(enrlDateOriginal, 'day')) {\n      validationResults.push(\n        imports.common.createValidationError(\"Enrolment Date cannot be changed.\")\n      );\n    }\n  }\n\n  return validationResults;\n};",
  "checklistsRule" : "",
  "decisionConcepts" : [ ]
}