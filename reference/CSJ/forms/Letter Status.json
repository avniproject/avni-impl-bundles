{
  "name" : "Letter Status",
  "uuid" : "b331d904-1948-4eab-8040-6fd995980253",
  "formType" : "ProgramEnrolment",
  "formElementGroups" : [ {
    "uuid" : "e72e4769-e7fa-4a61-8f9c-fe884dd85e66",
    "name" : "Letter Status Details",
    "displayOrder" : 1.0,
    "formElements" : [ {
      "name" : "Status",
      "uuid" : "ba796af3-7b4e-464c-9ef4-389dcb380277",
      "keyValues" : [ ],
      "concept" : {
        "name" : "Letter Status",
        "uuid" : "8bda3fb7-379c-4eaa-95fb-41a13fe28796",
        "dataType" : "Coded",
        "answers" : [ {
          "name" : "Initial letter filed",
          "uuid" : "99eca39a-1c8c-4d58-96be-6fb8de751161",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 0.0,
          "active" : true,
          "media" : [ ]
        }, {
          "name" : "Follow up letter filed",
          "uuid" : "024ed9b6-521e-4349-ba27-b18597176937",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 1.0,
          "active" : true,
          "media" : [ ]
        }, {
          "name" : "Closed",
          "uuid" : "d56b69db-da83-4f60-9a3f-4cc159e5e191",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 3.0,
          "active" : true,
          "media" : [ ]
        }, {
          "name" : "Follow up RTI filed",
          "uuid" : "8ef5b3db-a576-492a-8889-f1b271660b33",
          "dataType" : "NA",
          "answers" : [ ],
          "order" : 2.0,
          "active" : true,
          "media" : [ ]
        } ],
        "active" : true,
        "media" : [ ]
      },
      "displayOrder" : 1.0,
      "type" : "SingleSelect",
      "mandatory" : true
    } ],
    "display" : "Letter Status Details",
    "timed" : false
  } ],
  "decisionRule" : "\"use strict\";\n({params, imports}) => {\n    const programEnrolment = params.entity;\n    const decisions = params.decisions;\n    const moment = imports.moment;\n    const enrolmentDecisions = [];\n    \n    const enrolmentDateForEditCase = programEnrolment.getObservationValue(\"3ecdf82a-adf3-4e29-aa3f-244db1109a2d\");\n    \n    if (!enrolmentDateForEditCase) {\n      let enrlDateTime = moment().format(\"YYYY-MM-DD HH:mm:ss\");\n      \n      if (enrlDateTime) {\n        enrolmentDecisions.push({ name: \"Enrolment DateTime\", value: enrlDateTime });\n      }\n      decisions.enrolmentDecisions.push(...enrolmentDecisions);\n    }\n    \n    return decisions;\n};",
  "visitScheduleRule" : "",
  "validationRule" : "'use strict';\n({params, imports}) => {\n  const programEnrolment = params.entity;\n  const moment = imports.moment;\n  const validationResults = [];\n  \n  const enrolmentDateForEditCase = programEnrolment.getObservationValue(\"3ecdf82a-adf3-4e29-aa3f-244db1109a2d\");\n  const enrolmentDate = programEnrolment.enrolmentDateTime;\n\n  if (!enrolmentDateForEditCase) {\n    if (enrolmentDate) {\n      const today = moment().startOf('day');\n      const enrlDate = moment(enrolmentDate).startOf('day');\n\n      if (!enrlDate.isSame(today, 'day')) {\n        validationResults.push(\n          imports.common.createValidationError(\"Enrolment Date should be today's date.\")\n        );\n      }\n    }\n  } else {\n    const enrlDateEdit = moment(enrolmentDate).startOf('day');\n    const enrlDateOriginal = moment(enrolmentDateForEditCase).startOf('day');\n\n    if (!enrlDateEdit.isSame(enrlDateOriginal, 'day')) {\n      validationResults.push(\n        imports.common.createValidationError(\"Enrolment Date cannot be changed.\")\n      );\n    }\n  }\n\n  return validationResults;\n};",
  "checklistsRule" : "",
  "decisionConcepts" : [ ]
}